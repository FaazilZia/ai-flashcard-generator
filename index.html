<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Study & Flashcard Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeIn 0.8s ease;
        }

        .header h1 {
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 18px;
            opacity: 0.9;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .main-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.8s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e5e7eb;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .tab.active {
            color: #667eea;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        textarea, input, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        textarea {
            min-height: 200px;
            resize: vertical;
        }

        textarea:focus, input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 14px 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .output-section {
            margin-top: 40px;
            padding-top: 40px;
            border-top: 2px solid #e5e7eb;
            display: none;
        }

        .output-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .flashcard-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .flashcard {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .flashcard:hover {
            transform: translateY(-5px) scale(1.02);
        }

        .flashcard-front, .flashcard-back {
            font-size: 18px;
            line-height: 1.6;
        }

        .flashcard-back {
            display: none;
        }

        .flashcard.flipped .flashcard-front {
            display: none;
        }

        .flashcard.flipped .flashcard-back {
            display: block;
        }

        .quiz-container {
            margin-top: 20px;
        }

        .quiz-question {
            background: #f9fafb;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .quiz-question h3 {
            margin-bottom: 16px;
            color: #1f2937;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px 16px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: #667eea;
            background: #f3f4f6;
        }

        .notes-container {
            background: #f9fafb;
            border-radius: 12px;
            padding: 24px;
            margin-top: 20px;
        }

        .notes-container h3 {
            margin-bottom: 16px;
            color: #1f2937;
        }

        .notes-container ul {
            list-style-position: inside;
            line-height: 1.8;
            color: #374151;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #e5e7eb;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fee2e2;
            color: #991b1b;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .error.active {
            display: block;
        }

        .settings-card {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .settings-card h3 {
            margin-bottom: 16px;
            color: #1f2937;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 32px;
            }

            .main-card {
                padding: 24px;
            }

            .flashcard-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì AI Study Generator</h1>
            <p>Transform any text into flashcards, quizzes, and study notes instantly</p>
        </div>

        <div class="main-card">
            <!-- API Key Setup -->
            <div class="settings-card">
                <h3>‚öôÔ∏è Setup (One-time only)</h3>
                <div class="form-group">
                    <label for="apiKey">Hugging Face API Key (Free - Get it from <a href="https://huggingface.co/settings/tokens" target="_blank">here</a>)</label>
                    <input type="password" id="apiKey" placeholder="hf_...">
                    <small style="color: #6b7280; margin-top: 4px; display: block;">Your API key is stored locally in your browser and never sent anywhere except Hugging Face.</small>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('flashcards')">üìá Flashcards</button>
                <button class="tab" onclick="switchTab('quiz')">‚ùì Quiz</button>
                <button class="tab" onclick="switchTab('notes')">üìù Study Notes</button>
            </div>

            <!-- Flashcards Tab -->
            <div id="flashcards-tab" class="tab-content active">
                <div class="form-group">
                    <label for="flashcardText">Enter your text (article, chapter, notes)</label>
                    <textarea id="flashcardText" placeholder="Paste your study material here..."></textarea>
                </div>

                <div class="form-group">
                    <label for="flashcardCount">Number of Flashcards</label>
                    <select id="flashcardCount">
                        <option value="5">5 flashcards</option>
                        <option value="10" selected>10 flashcards</option>
                        <option value="15">15 flashcards</option>
                        <option value="20">20 flashcards</option>
                    </select>
                </div>

                <button class="btn" onclick="generateFlashcards()">‚ú® Generate Flashcards</button>

                <div class="loading" id="flashcards-loading">
                    <div class="spinner"></div>
                    <p>Generating your flashcards...</p>
                </div>

                <div class="error" id="flashcards-error"></div>

                <div class="output-section" id="flashcards-output">
                    <h2>Your Flashcards (Click to flip)</h2>
                    <div class="flashcard-container" id="flashcards-container"></div>
                </div>
            </div>

            <!-- Quiz Tab -->
            <div id="quiz-tab" class="tab-content">
                <div class="form-group">
                    <label for="quizText">Enter your text (article, chapter, notes)</label>
                    <textarea id="quizText" placeholder="Paste your study material here..."></textarea>
                </div>

                <div class="form-group">
                    <label for="quizCount">Number of Questions</label>
                    <select id="quizCount">
                        <option value="5" selected>5 questions</option>
                        <option value="10">10 questions</option>
                        <option value="15">15 questions</option>
                    </select>
                </div>

                <button class="btn" onclick="generateQuiz()">‚ú® Generate Quiz</button>

                <div class="loading" id="quiz-loading">
                    <div class="spinner"></div>
                    <p>Creating your quiz...</p>
                </div>

                <div class="error" id="quiz-error"></div>

                <div class="output-section" id="quiz-output">
                    <h2>Your Quiz</h2>
                    <div class="quiz-container" id="quiz-container"></div>
                </div>
            </div>

            <!-- Notes Tab -->
            <div id="notes-tab" class="tab-content">
                <div class="form-group">
                    <label for="notesText">Enter your text (article, chapter, notes)</label>
                    <textarea id="notesText" placeholder="Paste your study material here..."></textarea>
                </div>

                <button class="btn" onclick="generateNotes()">‚ú® Generate Study Notes</button>

                <div class="loading" id="notes-loading">
                    <div class="spinner"></div>
                    <p>Generating your study notes...</p>
                </div>

                <div class="error" id="notes-error"></div>

                <div class="output-section" id="notes-output">
                    <h2>Your Study Notes</h2>
                    <div class="notes-container" id="notes-container"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Load saved API key
        window.onload = function() {
            const savedKey = localStorage.getItem('hf_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
        };

        // Save API key
        document.getElementById('apiKey').addEventListener('change', function() {
            localStorage.setItem('hf_api_key', this.value);
        });

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        async function callHuggingFaceAPI(prompt) {
            const apiKey = document.getElementById('apiKey').value.trim();
            
            if (!apiKey) {
                throw new Error('Please enter your Hugging Face API key first!');
            }

            const response = await fetch('https://api-inference.huggingface.co/models/mistralai/Mixtral-8x7B-Instruct-v0.1', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    inputs: prompt,
                    parameters: {
                        max_new_tokens: 1000,
                        temperature: 0.7,
                        top_p: 0.95,
                        return_full_text: false
                    }
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'API request failed');
            }

            const result = await response.json();
            return result[0].generated_text;
        }

        async function generateFlashcards() {
            const text = document.getElementById('flashcardText').value.trim();
            const count = document.getElementById('flashcardCount').value;
            
            if (!text) {
                showError('flashcards', 'Please enter some text to generate flashcards!');
                return;
            }

            showLoading('flashcards', true);
            hideError('flashcards');
            hideOutput('flashcards');

            try {
                const prompt = `Create ${count} flashcards from the following text. Format each flashcard as:
Q: [Question]
A: [Answer]

Separate each flashcard with "---"

Text:
${text.substring(0, 2000)}`;

                const result = await callHuggingFaceAPI(prompt);
                const flashcards = parseFlashcards(result);
                displayFlashcards(flashcards);
            } catch (error) {
                showError('flashcards', error.message);
            } finally {
                showLoading('flashcards', false);
            }
        }

        function parseFlashcards(text) {
            const cards = [];
            const sections = text.split('---');
            
            sections.forEach(section => {
                const qMatch = section.match(/Q:\s*(.+?)(?=A:|$)/s);
                const aMatch = section.match(/A:\s*(.+?)$/s);
                
                if (qMatch && aMatch) {
                    cards.push({
                        question: qMatch[1].trim(),
                        answer: aMatch[1].trim()
                    });
                }
            });

            // Fallback if parsing fails
            if (cards.length === 0) {
                const lines = text.split('\n').filter(l => l.trim());
                for (let i = 0; i < lines.length - 1; i += 2) {
                    if (lines[i] && lines[i + 1]) {
                        cards.push({
                            question: lines[i].replace(/^Q:\s*/i, '').trim(),
                            answer: lines[i + 1].replace(/^A:\s*/i, '').trim()
                        });
                    }
                }
            }

            return cards;
        }

        function displayFlashcards(flashcards) {
            const container = document.getElementById('flashcards-container');
            container.innerHTML = '';

            flashcards.forEach((card, index) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'flashcard';
                cardDiv.onclick = function() { this.classList.toggle('flipped'); };
                cardDiv.innerHTML = `
                    <div class="flashcard-front">
                        <strong>Question ${index + 1}</strong><br><br>
                        ${card.question}
                    </div>
                    <div class="flashcard-back">
                        <strong>Answer</strong><br><br>
                        ${card.answer}
                    </div>
                `;
                container.appendChild(cardDiv);
            });

            showOutput('flashcards');
        }

        async function generateQuiz() {
            const text = document.getElementById('quizText').value.trim();
            const count = document.getElementById('quizCount').value;
            
            if (!text) {
                showError('quiz', 'Please enter some text to generate a quiz!');
                return;
            }

            showLoading('quiz', true);
            hideError('quiz');
            hideOutput('quiz');

            try {
                const prompt = `Create ${count} multiple choice questions from the following text. Format each question as:
Q: [Question]
A) [Option A]
B) [Option B]
C) [Option C]
D) [Option D]
Correct: [Letter]

Separate questions with "---"

Text:
${text.substring(0, 2000)}`;

                const result = await callHuggingFaceAPI(prompt);
                const questions = parseQuiz(result);
                displayQuiz(questions);
            } catch (error) {
                showError('quiz', error.message);
            } finally {
                showLoading('quiz', false);
            }
        }

        function parseQuiz(text) {
            const questions = [];
            const sections = text.split('---');
            
            sections.forEach(section => {
                const qMatch = section.match(/Q:\s*(.+?)(?=A\))/s);
                const options = section.match(/[A-D]\)\s*(.+?)(?=[A-D]\)|Correct:|$)/gs);
                const correctMatch = section.match(/Correct:\s*([A-D])/i);
                
                if (qMatch && options && correctMatch) {
                    questions.push({
                        question: qMatch[1].trim(),
                        options: options.map(o => o.trim()),
                        correct: correctMatch[1].toUpperCase()
                    });
                }
            });

            return questions;
        }

        function displayQuiz(questions) {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                
                let optionsHTML = '';
                q.options.forEach((option, i) => {
                    optionsHTML += `<div class="quiz-option">${option}</div>`;
                });

                questionDiv.innerHTML = `
                    <h3>Question ${index + 1}</h3>
                    <p>${q.question}</p>
                    <div class="quiz-options">${optionsHTML}</div>
                    <p style="margin-top: 12px; color: #667eea; font-weight: 600;">Correct Answer: ${q.correct}</p>
                `;
                container.appendChild(questionDiv);
            });

            showOutput('quiz');
        }

        async function generateNotes() {
            const text = document.getElementById('notesText').value.trim();
            
            if (!text) {
                showError('notes', 'Please enter some text to generate study notes!');
                return;
            }

            showLoading('notes', true);
            hideError('notes');
            hideOutput('notes');

            try {
                const prompt = `Summarize the following text into clear, organized study notes with key points and important concepts. Format as bullet points.

Text:
${text.substring(0, 2000)}`;

                const result = await callHuggingFaceAPI(prompt);
                displayNotes(result);
            } catch (error) {
                showError('notes', error.message);
            } finally {
                showLoading('notes', false);
            }
        }

        function displayNotes(notesText) {
            const container = document.getElementById('notes-container');
            const lines = notesText.split('\n').filter(l => l.trim());
            
            let html = '<ul>';
            lines.forEach(line => {
                const cleaned = line.replace(/^[-‚Ä¢*]\s*/, '').trim();
                if (cleaned) {
                    html += `<li>${cleaned}</li>`;
                }
            });
            html += '</ul>';

            container.innerHTML = html;
            showOutput('notes');
        }

        function showLoading(section, show) {
            const loading = document.getElementById(section + '-loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        function showError(section, message) {
            const error = document.getElementById(section + '-error');
            error.textContent = message;
            error.classList.add('active');
        }

        function hideError(section) {
            const error = document.getElementById(section + '-error');
            error.classList.remove('active');
        }

        function showOutput(section) {
            const output = document.getElementById(section + '-output');
            output.classList.add('active');
        }

        function hideOutput(section) {
            const output = document.getElementById(section + '-output');
            output.classList.remove('active');
        }
    </script>
</body>
</html>
